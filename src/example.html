<!DOCTYPE html>
<html>

<head>

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href="../jquery.datatables.yadcf.css" rel="stylesheet" type="text/css" />
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> -->
    <script  src="https://code.jquery.com/jquery-1.12.4.min.js"  integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="  crossorigin="anonymous"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/i18n/jquery-ui-i18n.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.15.0/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/3.5.4/css/select2.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/3.5.4/js/select2.js"></script> -->

    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.js"></script>

    <!-- https://cdnjs.cloudflare.com/ajax/libs/select2/3.5.4/select2.css -->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="jquery.dataTables.yadcf.js"></script>

    <script>
        $(document).ready(function() {
            var dataSet = [
    {
      id: {
        name: null
      },
      height: 150,
      level: 11,
      weight: 90,
      age: 45,
      number: null,
      salary: 1200,
      card: null,
      gender: 'male'
    },
    {
      id: {
        name: 2
      },
      height: null,
      level: 3,
      weight: 180,
      age: 75,
      number: 7,
      salary: null,
      card: 7777,
      gender: null
    },
    {
      id: {
        name: 3
      },
      height: null,
      level: null,
      weight: null,
      age: 15,
      number: 18,
      salary: 1800,
      card: 5555,
      gender: 'male'
    },
    {
      id: {
        name: 0
      },
      height: 0,
      level: 0,
      weight: 80,
      age: null,
      number: 666,
      salary: 10200,
      card: null,
      gender: 'male'
    },

  ];

  const renderObj = {
            _: (data, type, row, meta) => {
                return data;
            },
            // filter: (data, type, row, meta) => {
            //   return data === null ? 0 : data;
            // },
            display: (data, type, row, meta) => {
              return data === null ? 'null': data;
            }
  };
  /*function renderFunc(data, type, row, meta) {

    if (type === 'display') {

      return data === null ? 'null': data;
    }

    return data;
  }*/

  $(document).ready(function() {
    const table = $('#example').DataTable({
      data: dataSet,
      // stateSave: true,
      // serverSide: true,
      // ajax: "../server_side.php",
      columns: [{
          title: "ID",
          data: 'id.name',
          render: renderObj
        },
        {
          title: "height",
          data: 'height',
          render: renderObj,
        },
        {
          title: "level",
          data: 'level',
          render: renderObj,
        },
        {
          title: "weight",
          data: 'weight',
          render: renderObj,
        },
        {
          title: "age",
          data: 'age',
          render: renderObj,
        },
        {
          title: "lucky number",
          data: 'number',
          render: renderObj,
        },
        {
          title: "salary",
          data: 'salary',
          render: renderObj,
        },
        {
          title: "card",
          data: 'card',
          render: renderObj,
        },
        // {
        //   title: "gender",
        //   data: 'gender',
        //   render: renderFunc,
        // },
      ]
    });

    yadcf.init(table, [
      {
        column_number: 0,
        data: [null, 0, 2, 3],
        select_type: 'select2',
        filter_type: "select",
        exclude: true,
        exclude_label: 'EXCLUDE',
        checkbox_position_after: true,
        filter_match_mode: 'exact',
        /*externally_triggered_checkboxes_text: 'O',
        externally_triggered_checkboxes_function: (event) => {
          const parent = $(event.target).parent();
          const exclude = parent.find('.yadcf-exclude-wrapper input');
          checkedEx  = exclude.prop('checked') ? 'checked' : '';
          ex = function() {
            exclude.trigger('click')
          };
          const content = `
          <input id="checkedExx" type="checkbox" title="exclude" onclick="ex()"> Exclude <br>
          `;
          $(event.target).popover({
            placement:'right',
            trigger: 'focus',
            html: true,
            sanitize: false,
            content: content
          });
          $(event.target).popover('show');
          $('#checkedExx').prop('checked', checkedEx);
		    }*/
      },
      {
        column_number: 1,
        filter_type: "text",
        null_check_box: true,
        exclude: true,
        regex_check_box: true,
        checkbox_position_after: true,
        /*externally_triggered_checkboxes_text: 'O',
        externally_triggered_checkboxes_function: (event) => {
          const parent = $(event.target).parent();
          const exclude = parent.find('.yadcf-exclude-wrapper input');
          checkedEx  = exclude.prop('checked') ? 'checked' : '';
          const regex = parent.find('.yadcf-regex-wrapper input');
          checkedReg  = regex.prop('checked') ? 'checked' : '';
          const nullC = parent.find('.yadcf-null-wrapper input');
          checkedNull  = nullC.prop('checked') ? 'checked' : '';
          ex = function() {
            exclude.trigger('click')
          };
          reg = function() {
            regex.trigger('click')
          };
          nulll = function() {
            nullC.trigger('click');
          };
          const content = `<input id="checkedEx" type="checkbox" title="exclude" onclick="ex()"> Exclude <br>
          <input type="checkbox" id="checkedReg" title="regex" onclick="reg()"> Regex <br>
          <input type="checkbox" id="checkedNull" title="null" onclick="nulll()"> Null <br>
          `;
          $(event.target).popover({
            placement:'right',
            trigger: 'manual',
            html: true,
            sanitize: false,
            content: content
          });
          $(event.target).popover('toggle');
          $('#checkedEx').prop('checked', checkedEx);
          $('#checkedReg').prop('checked', checkedReg);
          $('#checkedNull').prop('checked', checkedNull);
		    }*/
      },
      {
        column_number: 2,
        filter_type: "range_number",
        null_check_box: true,
        exclude: true,
        checkbox_position_after: true,
        /*externally_triggered_checkboxes_text: 'O',
        externally_triggered_checkboxes_function: (event) => {
          const parent = $(event.target).parent();
          const exclude = parent.find('.yadcf-exclude-wrapper input');
          checkedEx  = exclude.prop('checked') ? 'checked' : '';
          const nullC = parent.find('.yadcf-null-wrapper input');
          checkedNull  = nullC.prop('checked') ? 'checked' : '';
          ex = function() {
            exclude.trigger('click')
          };
          nulll = function() {
            nullC.trigger('click');
          };
          const content = `
          <input id="checkedExx" type="checkbox" title="exclude" onclick="ex()"> Exclude <br>
          <input id="checkedNulll" type="checkbox" title="null" onclick="nulll()"> Null <br>
          `;
          $(event.target).popover({
            placement:'right',
            trigger: 'focus',
            html: true,
            content: content,
            sanitize: false,
          });
          $(event.target).popover('show');
          $('#checkedExx').prop('checked', checkedEx);
          $('#checkedNulll').prop('checked', checkedNull);
		    }*/
      },
      // {
      //   column_number: 3,
      //   filter_type: "text",
      //   exclude: true,
      //   // filter_reset_button_text: false,
      // },
      // {
      //   column_number: 4,
      //   filter_type: "range_number",
      //   // filter_reset_button_text: false,
      // },
      // {
      //   column_number: 5,
      //   filter_type: "text",
      //   null_check_box: true,
      //   // filter_reset_button_text: false,
      //   exclude: true
      // },
      // {
      //   column_number: 6,
      //   filter_type: "text",
      //   // filter_reset_button_text: false,
      // },
      // {
      //   column_number: 7,
      //   filter_type: "text",
      //   null_check_box: true,
      //   filter_reset_button_text: false,
      //   exclude: true,
      //   regex_check_box: true,
      //   // checkbox_position_after: true
      // }
    ]);

    var counter = 1;
    $('#resetAll').click(function(e, dt, button, conf) {
      var t = $('#example').DataTable();
      t.row.add(
      {
      id: {
        name: counter
      },
      height: 666,
      level: 66,
      weight: 6666,
      age: 66,
      number: 6,
      salary: 6666,
      card: 6666,
      gender: 'male'
    }).draw( false );
      data = [null, 0, 2, 3, 5],
      yadcf.exRefreshColumnFilterWithDataProp(t, 0, data);
      counter++;
     });

    });

        });
    </script>
    <meta charset=utf-8 />
    <title>yadcf - Yet Another DataTables Column Filter</title>
</head>

<body id="yadcf_example">
    <table id="example" class="display" width="100%">
    <!-- <thead>
      <tr>
          <th>#</th>
          <th> Level </th>
      </tr>
  </thead>
  <tbody>
      <tr>
        <td>null</td>
        <td>1</td>
      </tr>
      <tr>
        <td>2</td>
        <td>5</td>
      </tr>
      <tr>
        <td>3</td>
        <td>8</td>
      </tr>
      <tr>
        <td>4</td>
        <td>2</td>
      </tr>
      <tr>
        <td>5</td>
        <td>null</td>
      </tr>
    </tbody> -->
  </table>
</body>
<button id="resetAll">
        reset all
        </button>
</html>
